Did I say you shoudn't use this?
Well, now there you have the disclaimer.

###Don't use this code. 

It's broken badly. If you use and lose data, I can't help you.

--
Mugunth